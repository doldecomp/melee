.include "macros.inc"

.section .text  # 0x80005940 - 0x803B7240

.global TRKInitializeEventQueue
TRKInitializeEventQueue:
/* 8032687C 0032345C  7C 08 02 A6 */	mflr r0
/* 80326880 00323460  3C 60 80 4A */	lis r3, gTRKEventQueue@ha
/* 80326884 00323464  90 01 00 04 */	stw r0, 4(r1)
/* 80326888 00323468  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 8032688C 0032346C  93 E1 00 0C */	stw r31, 0xc(r1)
/* 80326890 00323470  3B E3 31 48 */	addi r31, r3, gTRKEventQueue@l
/* 80326894 00323474  38 7F 00 00 */	addi r3, r31, 0
/* 80326898 00323478  48 00 25 C9 */	bl TRKInitializeMutex
/* 8032689C 0032347C  7F E3 FB 78 */	mr r3, r31
/* 803268A0 00323480  48 00 25 C9 */	bl TRKAcquireMutex
/* 803268A4 00323484  38 60 00 00 */	li r3, 0
/* 803268A8 00323488  90 7F 00 04 */	stw r3, 4(r31)
/* 803268AC 0032348C  38 00 01 00 */	li r0, 0x100
/* 803268B0 00323490  90 7F 00 08 */	stw r3, 8(r31)
/* 803268B4 00323494  7F E3 FB 78 */	mr r3, r31
/* 803268B8 00323498  90 1F 00 24 */	stw r0, 0x24(r31)
/* 803268BC 0032349C  48 00 25 B5 */	bl TRKReleaseMutex
/* 803268C0 003234A0  38 60 00 00 */	li r3, 0
/* 803268C4 003234A4  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 803268C8 003234A8  38 21 00 10 */	addi r1, r1, 0x10
/* 803268CC 003234AC  80 01 00 04 */	lwz r0, 4(r1)
/* 803268D0 003234B0  7C 08 03 A6 */	mtlr r0
/* 803268D4 003234B4  4E 80 00 20 */	blr

.global __TRK_memcpy
__TRK_memcpy:
/* 803268D8 003234B8  7C 08 02 A6 */	mflr r0
/* 803268DC 003234BC  38 A0 00 0C */	li r5, 0xc
/* 803268E0 003234C0  90 01 00 04 */	stw r0, 4(r1)
/* 803268E4 003234C4  94 21 FF F8 */	stwu r1, -8(r1)
/* 803268E8 003234C8  4B CD C9 5D */	bl TRK_memcpy
/* 803268EC 003234CC  38 21 00 08 */	addi r1, r1, 8
/* 803268F0 003234D0  80 01 00 04 */	lwz r0, 4(r1)
/* 803268F4 003234D4  7C 08 03 A6 */	mtlr r0
/* 803268F8 003234D8  4E 80 00 20 */	blr

.global TRKGetNextEvent
TRKGetNextEvent:
/* 803268FC 003234DC  7C 08 02 A6 */	mflr r0
/* 80326900 003234E0  3C 80 80 4A */	lis r4, gTRKEventQueue@ha
/* 80326904 003234E4  90 01 00 04 */	stw r0, 4(r1)
/* 80326908 003234E8  94 21 FF E8 */	stwu r1, -0x18(r1)
/* 8032690C 003234EC  93 E1 00 14 */	stw r31, 0x14(r1)
/* 80326910 003234F0  3B E4 31 48 */	addi r31, r4, gTRKEventQueue@l
/* 80326914 003234F4  93 C1 00 10 */	stw r30, 0x10(r1)
/* 80326918 003234F8  93 A1 00 0C */	stw r29, 0xc(r1)
/* 8032691C 003234FC  3B A0 00 00 */	li r29, 0
/* 80326920 00323500  93 81 00 08 */	stw r28, 8(r1)
/* 80326924 00323504  3B 83 00 00 */	addi r28, r3, 0
/* 80326928 00323508  38 7F 00 00 */	addi r3, r31, 0
/* 8032692C 0032350C  48 00 25 3D */	bl TRKAcquireMutex
/* 80326930 00323510  3B DF 00 04 */	addi r30, r31, 4
/* 80326934 00323514  80 1F 00 04 */	lwz r0, 4(r31)
/* 80326938 00323518  2C 00 00 00 */	cmpwi r0, 0
/* 8032693C 0032351C  40 81 00 50 */	ble .L_8032698C
/* 80326940 00323520  3B BF 00 08 */	addi r29, r31, 8
/* 80326944 00323524  80 1F 00 08 */	lwz r0, 8(r31)
/* 80326948 00323528  38 7C 00 00 */	addi r3, r28, 0
/* 8032694C 0032352C  1C 00 00 0C */	mulli r0, r0, 0xc
/* 80326950 00323530  7C 9F 02 14 */	add r4, r31, r0
/* 80326954 00323534  38 84 00 0C */	addi r4, r4, 0xc
/* 80326958 00323538  4B FF FF 81 */	bl __TRK_memcpy
/* 8032695C 0032353C  80 7E 00 00 */	lwz r3, 0(r30)
/* 80326960 00323540  38 03 FF FF */	addi r0, r3, -1
/* 80326964 00323544  90 1E 00 00 */	stw r0, 0(r30)
/* 80326968 00323548  80 7D 00 00 */	lwz r3, 0(r29)
/* 8032696C 0032354C  38 03 00 01 */	addi r0, r3, 1
/* 80326970 00323550  90 1D 00 00 */	stw r0, 0(r29)
/* 80326974 00323554  80 1D 00 00 */	lwz r0, 0(r29)
/* 80326978 00323558  2C 00 00 02 */	cmpwi r0, 2
/* 8032697C 0032355C  40 82 00 0C */	bne .L_80326988
/* 80326980 00323560  38 00 00 00 */	li r0, 0
/* 80326984 00323564  90 1D 00 00 */	stw r0, 0(r29)
.L_80326988:
/* 80326988 00323568  3B A0 00 01 */	li r29, 1
.L_8032698C:
/* 8032698C 0032356C  3C 60 80 4A */	lis r3, gTRKEventQueue@ha
/* 80326990 00323570  38 63 31 48 */	addi r3, r3, gTRKEventQueue@l
/* 80326994 00323574  48 00 24 DD */	bl TRKReleaseMutex
/* 80326998 00323578  7F A3 EB 78 */	mr r3, r29
/* 8032699C 0032357C  83 E1 00 14 */	lwz r31, 0x14(r1)
/* 803269A0 00323580  83 C1 00 10 */	lwz r30, 0x10(r1)
/* 803269A4 00323584  83 A1 00 0C */	lwz r29, 0xc(r1)
/* 803269A8 00323588  83 81 00 08 */	lwz r28, 8(r1)
/* 803269AC 0032358C  38 21 00 18 */	addi r1, r1, 0x18
/* 803269B0 00323590  80 01 00 04 */	lwz r0, 4(r1)
/* 803269B4 00323594  7C 08 03 A6 */	mtlr r0
/* 803269B8 00323598  4E 80 00 20 */	blr

.global TRKPostEvent
TRKPostEvent:
/* 803269BC 0032359C  7C 08 02 A6 */	mflr r0
/* 803269C0 003235A0  3C 80 80 4A */	lis r4, gTRKEventQueue@ha
/* 803269C4 003235A4  90 01 00 04 */	stw r0, 4(r1)
/* 803269C8 003235A8  94 21 FF E8 */	stwu r1, -0x18(r1)
/* 803269CC 003235AC  93 E1 00 14 */	stw r31, 0x14(r1)
/* 803269D0 003235B0  3B E3 00 00 */	addi r31, r3, 0
/* 803269D4 003235B4  93 C1 00 10 */	stw r30, 0x10(r1)
/* 803269D8 003235B8  3B C4 31 48 */	addi r30, r4, gTRKEventQueue@l
/* 803269DC 003235BC  38 7E 00 00 */	addi r3, r30, 0
/* 803269E0 003235C0  93 A1 00 0C */	stw r29, 0xc(r1)
/* 803269E4 003235C4  93 81 00 08 */	stw r28, 8(r1)
/* 803269E8 003235C8  3B 80 00 00 */	li r28, 0
/* 803269EC 003235CC  48 00 24 7D */	bl TRKAcquireMutex
/* 803269F0 003235D0  3B BE 00 04 */	addi r29, r30, 4
/* 803269F4 003235D4  80 7E 00 04 */	lwz r3, 4(r30)
/* 803269F8 003235D8  2C 03 00 02 */	cmpwi r3, 2
/* 803269FC 003235DC  40 82 00 0C */	bne .L_80326A08
/* 80326A00 003235E0  3B 80 01 00 */	li r28, 0x100
/* 80326A04 003235E4  48 00 00 68 */	b .L_80326A6C
.L_80326A08:
/* 80326A08 003235E8  80 1E 00 08 */	lwz r0, 8(r30)
/* 80326A0C 003235EC  38 9F 00 00 */	addi r4, r31, 0
/* 80326A10 003235F0  7C 00 1A 14 */	add r0, r0, r3
/* 80326A14 003235F4  7C 03 0E 70 */	srawi r3, r0, 1
/* 80326A18 003235F8  7C 63 01 94 */	addze r3, r3
/* 80326A1C 003235FC  54 63 08 3C */	slwi r3, r3, 1
/* 80326A20 00323600  7C 63 00 10 */	subfc r3, r3, r0
/* 80326A24 00323604  1C 03 00 0C */	mulli r0, r3, 0xc
/* 80326A28 00323608  7F FE 02 14 */	add r31, r30, r0
/* 80326A2C 0032360C  38 7F 00 0C */	addi r3, r31, 0xc
/* 80326A30 00323610  4B FF FE A9 */	bl __TRK_memcpy
/* 80326A34 00323614  38 9E 00 24 */	addi r4, r30, 0x24
/* 80326A38 00323618  80 1E 00 24 */	lwz r0, 0x24(r30)
/* 80326A3C 0032361C  90 1F 00 10 */	stw r0, 0x10(r31)
/* 80326A40 00323620  80 7E 00 24 */	lwz r3, 0x24(r30)
/* 80326A44 00323624  38 03 00 01 */	addi r0, r3, 1
/* 80326A48 00323628  90 1E 00 24 */	stw r0, 0x24(r30)
/* 80326A4C 0032362C  80 1E 00 24 */	lwz r0, 0x24(r30)
/* 80326A50 00323630  28 00 01 00 */	cmplwi r0, 0x100
/* 80326A54 00323634  40 80 00 0C */	bge .L_80326A60
/* 80326A58 00323638  38 00 01 00 */	li r0, 0x100
/* 80326A5C 0032363C  90 04 00 00 */	stw r0, 0(r4)
.L_80326A60:
/* 80326A60 00323640  80 7D 00 00 */	lwz r3, 0(r29)
/* 80326A64 00323644  38 03 00 01 */	addi r0, r3, 1
/* 80326A68 00323648  90 1D 00 00 */	stw r0, 0(r29)
.L_80326A6C:
/* 80326A6C 0032364C  3C 60 80 4A */	lis r3, gTRKEventQueue@ha
/* 80326A70 00323650  38 63 31 48 */	addi r3, r3, gTRKEventQueue@l
/* 80326A74 00323654  48 00 23 FD */	bl TRKReleaseMutex
/* 80326A78 00323658  7F 83 E3 78 */	mr r3, r28
/* 80326A7C 0032365C  83 E1 00 14 */	lwz r31, 0x14(r1)
/* 80326A80 00323660  83 C1 00 10 */	lwz r30, 0x10(r1)
/* 80326A84 00323664  83 A1 00 0C */	lwz r29, 0xc(r1)
/* 80326A88 00323668  83 81 00 08 */	lwz r28, 8(r1)
/* 80326A8C 0032366C  38 21 00 18 */	addi r1, r1, 0x18
/* 80326A90 00323670  80 01 00 04 */	lwz r0, 4(r1)
/* 80326A94 00323674  7C 08 03 A6 */	mtlr r0
/* 80326A98 00323678  4E 80 00 20 */	blr

.global TRKConstructEvent
TRKConstructEvent:
/* 80326A9C 0032367C  98 83 00 00 */	stb r4, 0(r3)
/* 80326AA0 00323680  38 80 00 00 */	li r4, 0
/* 80326AA4 00323684  38 00 FF FF */	li r0, -1
/* 80326AA8 00323688  90 83 00 04 */	stw r4, 4(r3)
/* 80326AAC 0032368C  90 03 00 08 */	stw r0, 8(r3)
/* 80326AB0 00323690  4E 80 00 20 */	blr

.global TRKDestructEvent
TRKDestructEvent:
/* 80326AB4 00323694  7C 08 02 A6 */	mflr r0
/* 80326AB8 00323698  90 01 00 04 */	stw r0, 4(r1)
/* 80326ABC 0032369C  94 21 FF F8 */	stwu r1, -8(r1)
/* 80326AC0 003236A0  80 63 00 08 */	lwz r3, 8(r3)
/* 80326AC4 003236A4  48 00 03 19 */	bl TRKReleaseBuffer
/* 80326AC8 003236A8  38 21 00 08 */	addi r1, r1, 8
/* 80326ACC 003236AC  80 01 00 04 */	lwz r0, 4(r1)
/* 80326AD0 003236B0  7C 08 03 A6 */	mtlr r0
/* 80326AD4 003236B4  4E 80 00 20 */	blr


.section .bss, "wa"
.global gTRKEventQueue
gTRKEventQueue:
    .skip 0x28